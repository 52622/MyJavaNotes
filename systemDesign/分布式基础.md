分布式锁



获得锁时向表中插入一条记录，释放锁时删除这条记录 

唯一索引可以保证该记录只被插入一次 



Redis 的 SETNX 指令

SETNX（set if not exist）指令插入一个键值对 

如果 Key 已经存在，那么会返回 False，否则插入成功并返回 True 

EXPIRE 指令可以为一个键值对设置一个过期时间，从而避免了数据库唯一索引实现方式中释放锁失败的问题 



![1552292362491](assets/1552292362491.png)



zk



